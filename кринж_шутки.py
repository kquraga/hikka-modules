from hikkatl.types import Message
from .. import loader, utils
import random

@loader.tds
class –ö—Ä–∏–Ω–∂–®—É—Ç–∫–∏(loader.Module):
    """–ö–æ–ª–ª–µ–∫—Ü–∏—è —Å–∞–º—ã—Ö –∫—Ä–∏–Ω–∂–æ–≤—ã—Ö —à—É—Ç–æ–∫"""
    strings = {
        "name": "–ö—Ä–∏–Ω–∂–®—É—Ç–∫–∏",
        "joke": "ü§° <b>–ö—Ä–∏–Ω–∂-—à—É—Ç–∫–∞:</b>\n\n{}",
        "bomb": "üí£ <b>–ì–æ—Ç–æ–≤—å—Ç–µ—Å—å –∫ –∫—Ä–∏–Ω–∂-–∞—Ç–∞–∫–µ!</b>"
    }

    jokes = [
        "–Ø –Ω–µ —Ç–æ–∫—Å–∏—á–Ω—ã–π, —è –ø—Ä–æ—Å—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É—é —Ç–≤–æ—é –ø—Å–∏—Ö–∏–∫—É –Ω–∞ –ø—Ä–æ—á–Ω–æ—Å—Ç—å",
        "–ú–æ—è –∂–∏–∑–Ω—å ‚Äî —ç—Ç–æ –±–∞–≥, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–µ —Ö–æ—Ç—è—Ç —Ñ–∏–∫—Å–∏—Ç—å",
        "–¢—ã –Ω–µ –∫—Ä–∏–Ω–∂–æ–≤—ã–π, —Ç—ã –ø—Ä–æ—Å—Ç–æ —Ä–∞–Ω–Ω—è—è –±–µ—Ç–∞-–≤–µ—Ä—Å–∏—è —á–µ–ª–æ–≤–µ–∫–∞",
        "–Ø –∫–∞–∫ Windows XP ‚Äî –≤—Å–µ –∑–Ω–∞—é—Ç, —á—Ç–æ —É–º–µ—Ä, –Ω–æ –Ω–æ—Å—Ç–∞–ª—å–≥–∏—Ä—É—é—Ç",
        "–ú–æ–∏ —Å–æ—Ü–Ω–∞–≤—ã–∫–∏ ‚Äî —ç—Ç–æ DLC, –∫–æ—Ç–æ—Ä–æ–µ —è –Ω–µ –∫—É–ø–∏–ª",
        "–û—à–∏–±–∫–∞ 404: –õ–∏—á–Ω–æ—Å—Ç—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞",
        "–£ –º–µ–Ω—è –Ω–µ—Ç –ø—Ä–æ–±–ª–µ–º —Å –¥–æ–≤–µ—Ä–∏–µ–º, —É –º–µ–Ω—è –ø—Ä–æ–±–ª–µ–º—ã —Å '–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∞—è –≤–µ—Ä—Å–∏—è'",
        "–ú–æ—ë —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ ‚Äî —ç—Ç–æ —Å—Ç–∏–∫–µ—Ä '–£ –º–µ–Ω—è —Ä–∞–±–æ—Ç–∞–µ—Ç'"
    ]

    @loader.command(
        ru_doc="–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–ª—É—á–∞–π–Ω—É—é –∫—Ä–∏–Ω–∂-—à—É—Ç–∫—É",
        en_doc="Send random cringe joke"
    )
    async def –∫—Ä–∏–Ω–∂(self, message: Message):
        """–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–ª—É—á–∞–π–Ω—É—é –∫—Ä–∏–Ω–∂-—à—É—Ç–∫—É"""
        await utils.answer(message, self.strings("joke").format(random.choice(self.jokes)))

    @loader.command(
        ru_doc="–û—Ç–ø—Ä–∞–≤–∏—Ç—å 5 –∫—Ä–∏–Ω–∂-—à—É—Ç–æ–∫ –ø–æ–¥—Ä—è–¥",
        en_doc="Send 5 cringe jokes in a row"
    )
    async def –∫—Ä–∏–Ω–∂–∞—Ç–∞–∫–∞(self, message: Message):
        """–ó–∞–≤–∞–ª–∏—Ç—å —á–∞—Ç –∫—Ä–∏–Ω–∂–æ–º"""
        await utils.answer(message, self.strings("bomb"))
        for _ in range(5):
            await self.–∫—Ä–∏–Ω–∂(message)

    @loader.watcher(only_messages=True, only_pm=True)
    async def watcher(self, message: Message):
        """–ê–≤—Ç–æ–æ—Ç–≤–µ—Ç –Ω–∞ '–∫—Ä–∏–Ω–∂' –≤ –ª–∏—á–∫–µ"""
        if "–∫—Ä–∏–Ω–∂" in message.raw_text.lower():
            await self.–∫—Ä–∏–Ω–∂(message)